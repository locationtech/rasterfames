<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="RasterFrames brings the power of Spark DataFrames to geospatial raster data.">
<meta name="generator" content="Paradox, paradox-material-theme=0.6.0, mkdocs-material=3.0.3">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.language" content="">
<meta name="lang:search.pipeline.stopwords" content="true">
<meta name="lang:search.pipeline.trimmer" content="true">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="RasterFrames brings the power of Spark DataFrames to geospatial raster data.">
<link rel="shortcut icon" href="assets/images/RasterFrames_32x32.ico">
<title>Scala and SQL Â· RasterFrames</title>
<link rel="stylesheet" href="assets/stylesheets/application.451f80e5.css">
<link rel="stylesheet" href="assets/stylesheets/application-palette.22915126.css">
<meta name="theme-color" content="#546e7a" />
<link rel="stylesheet" href="lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="lib/prettify/prettify.css">
<script src="assets/javascripts/modernizr.1aa3b519.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="assets/fonts/font-awesome.css">
<link rel="stylesheet" href="assets/fonts/material-icons.css">
<link rel="stylesheet" href="assets/stylesheets/paradox-material-theme.css">
<link rel="stylesheet" href="assets/custom.css">
</head>
<body
data-md-color-primary="blue-grey"
data-md-color-accent="light-blue"
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="index.html" title="RasterFrames" class="md-header-nav__button md-logo">
<img src="assets/images/RF-R.svg" width="24" height="24">
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
RasterFrames
</span>
<span class="md-header-nav__topic">
Scala and SQL
</span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
<label class="md-icon md-search__icon" for="__search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
<div class="md-flex__cell md-flex__cell--shrink">
<div class="md-header-nav__source">
<a href="https://github.com/locationtech/rasterframes"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
locationtech/rasterframes
</div>
</a>

</div>
</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<a href="index.html" title="RasterFrames" class="md-nav__button md-logo">
<span class="md-nav__button md-logo">
<img src="assets/images/RF-R.svg" width="24" height="24">
</a>
<a href="index.html" title="RasterFrames">
RasterFrames
</a>
</label>
<div class="md-nav__source">
<a href="https://github.com/locationtech/rasterframes"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
locationtech/rasterframes
</div>
</a>

</div>
<ul>
  <li><a href="description.html" class="page">Overview</a></li>
  <li><a href="getting-started.html" class="page">Getting Started</a></li>
  <li><a href="concepts.html" class="page">Concepts</a></li>
  <li><a href="raster-io.html" class="page">Raster Data I/O</a>
  <ul>
    <li><a href="raster-catalogs.html" class="page">Raster Catalogs</a></li>
    <li><a href="raster-read.html" class="page">Reading Raster Data</a></li>
    <li><a href="raster-write.html" class="page">Writing Raster Data</a></li>
  </ul></li>
  <li><a href="vector-data.html" class="page">Vector Data</a></li>
  <li><a href="raster-processing.html" class="page">Raster Processing</a>
  <ul>
    <li><a href="local-algebra.html" class="page">Local Map Algebra</a></li>
    <li><a href="nodata-handling.html" class="page">&ldquo;NoData&rdquo; Handling</a></li>
    <li><a href="masking.html" class="page">Masking</a></li>
    <li><a href="zonal-algebra.html" class="page">Zonal Map Algebra</a></li>
    <li><a href="aggregation.html" class="page">Aggregation</a></li>
    <li><a href="time-series.html" class="page">Time Series</a></li>
    <li><a href="raster-join.html" class="page">Raster Join</a></li>
  </ul></li>
  <li><a href="machine-learning.html" class="page">Machine Learning</a>
  <ul>
    <li><a href="unsupervised-learning.html" class="page">Unsupervised Machine Learning</a></li>
    <li><a href="supervised-learning.html" class="page">Supervised Machine Learning</a></li>
  </ul></li>
  <li><a href="numpy-pandas.html" class="page">NumPy and Pandas</a></li>
  <li><a href="ipython.html" class="page">IPython/Jupyter Extensions</a></li>
  <li><a href="languages.html" class="active page">Scala and SQL</a></li>
  <li><a href="reference.html" class="page">Function Reference</a></li>
  <li><a href="release-notes.html" class="page">Release Notes</a></li>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="languages.html#scala-and-sql" class="header">Scala and SQL</a>
  <ul>
    <li><a href="languages.html#python" class="header">Python</a></li>
    <li><a href="languages.html#sql" class="header">SQL</a></li>
    <li><a href="languages.html#scala" class="header">Scala</a></li>
  </ul></li>
</ul>
</nav>

</nav>
<ul style="display: none">
<li class="md-nav__item md-version" id="project.version">
<label class="md-nav__link" for="__version">
<i class="md-icon" title="Version">label_outline</i> 0.9.1
</label>
</li>
</ul>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="languages.html#scala-and-sql" class="header">Scala and SQL</a>
  <ul>
    <li><a href="languages.html#python" class="header">Python</a></li>
    <li><a href="languages.html#sql" class="header">SQL</a></li>
    <li><a href="languages.html#scala" class="header">Scala</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<h1><a href="#scala-and-sql" name="scala-and-sql" class="anchor"><span class="anchor-link"></span></a>Scala and SQL</h1>
<p>One of the great powers of RasterFrames is the ability to express computation in multiple programming languages. The content in this manual focuses on Python because it is the most commonly used language in data science and GIS analytics. However, Scala (the implementation language of RasterFrames) and SQL (commonly used in many domains) are also fully supported. Examples in Python can be mechanically translated into the other two languages without much difficulty once the naming conventions are understood. </p>
<p>In the sections below we will show the same example program in each language. To do so we will compute the average NDVI per month for a single <em>tile</em> in Tanzania.</p>
<h2><a href="#python" name="python" class="anchor"><span class="anchor-link"></span></a>Python</h2>
<h3><a href="#step-1-load-the-catalog" name="step-1-load-the-catalog" class="anchor"><span class="anchor-link"></span></a>Step 1: Load the catalog</h3>
<pre class="prettyprint"><code class="language-python">modis = spark.read.format(&#39;aws-pds-modis-catalog&#39;).load()
</code></pre>
<h3><a href="#step-2-down-select-data-by-month" name="step-2-down-select-data-by-month" class="anchor"><span class="anchor-link"></span></a>Step 2: Down-select data by month</h3>
<pre class="prettyprint"><code class="language-python">red_nir_monthly_2017 = modis \
    .select(
        col(&#39;granule_id&#39;),
        month(&#39;acquisition_date&#39;).alias(&#39;month&#39;),
        col(&#39;B01&#39;).alias(&#39;red&#39;),
        col(&#39;B02&#39;).alias(&#39;nir&#39;)
    ) \
    .where(
        (year(&#39;acquisition_date&#39;) == 2017) &amp; 
        (dayofmonth(&#39;acquisition_date&#39;) == 15) &amp; 
        (col(&#39;granule_id&#39;) == &#39;h21v09&#39;)
    )
red_nir_monthly_2017.printSchema()
</code></pre>
<pre><code>root
 |-- granule_id: string (nullable = false)
 |-- month: integer (nullable = false)
 |-- red: string (nullable = true)
 |-- nir: string (nullable = true)
</code></pre>
<h3><a href="#step-3-read-tiles" name="step-3-read-tiles" class="anchor"><span class="anchor-link"></span></a>Step 3: Read tiles</h3>
<pre class="prettyprint"><code class="language-python">red_nir_tiles_monthly_2017 = spark.read.raster(
    red_nir_monthly_2017,
    catalog_col_names=[&#39;red&#39;, &#39;nir&#39;],
    tile_dimensions=(256, 256)
)
</code></pre>
<h3><a href="#step-4-compute-aggregates" name="step-4-compute-aggregates" class="anchor"><span class="anchor-link"></span></a>Step 4: Compute aggregates</h3>
<pre class="prettyprint"><code class="language-python">result = red_nir_tiles_monthly_2017 \
    .where(st_intersects(
        st_reproject(rf_geometry(col(&#39;red&#39;)), rf_crs(col(&#39;red&#39;)).crsProj4, rf_mk_crs(&#39;EPSG:4326&#39;)),
        st_makePoint(lit(34.870605), lit(-4.729727)))
    ) \
    .groupBy(&#39;month&#39;) \
    .agg(rf_agg_stats(rf_normalized_difference(col(&#39;nir&#39;), col(&#39;red&#39;))).alias(&#39;ndvi_stats&#39;)) \
    .orderBy(col(&#39;month&#39;)) \
    .select(&#39;month&#39;, &#39;ndvi_stats.*&#39;)
result
</code></pre>
<p><em>Showing only top 5 rows</em>.</p>
<table>
  <thead>
    <tr>
      <th>month </th>
      <th>data_cells </th>
      <th>no_data_cells </th>
      <th>min </th>
      <th>max </th>
      <th>mean </th>
      <th>variance </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1 </td>
      <td>65523 </td>
      <td>13 </td>
      <td>-0.2519809825673534 </td>
      <td>0.8644836272040303 </td>
      <td>0.4062596673810191 </td>
      <td>0.01407280838385605 </td>
    </tr>
    <tr>
      <td>2 </td>
      <td>65521 </td>
      <td>15 </td>
      <td>-0.21232123212321233 </td>
      <td>0.8872390789756832 </td>
      <td>0.46738863804011127 </td>
      <td>0.011822698212885174 </td>
    </tr>
    <tr>
      <td>3 </td>
      <td>64425 </td>
      <td>1111 </td>
      <td>-0.36211340206185566 </td>
      <td>0.9208261617900172 </td>
      <td>0.5811071411891395 </td>
      <td>0.011570245465885753 </td>
    </tr>
    <tr>
      <td>4 </td>
      <td>64236 </td>
      <td>1300 </td>
      <td>-0.17252657399836469 </td>
      <td>0.922397476340694 </td>
      <td>0.5254596885897274 </td>
      <td>0.01087259231886667 </td>
    </tr>
    <tr>
      <td>5 </td>
      <td>60819 </td>
      <td>4717 </td>
      <td>-0.19951338199513383 </td>
      <td>0.916626036079961 </td>
      <td>0.46471430090039234 </td>
      <td>0.01215478443067744 </td>
    </tr>
  </tbody>
</table>
<h2><a href="#sql" name="sql" class="anchor"><span class="anchor-link"></span></a>SQL</h2>
<p>For convenience, we&rsquo;re going to evaluate SQL from the Python environment. The SQL fragments should work in the <code>spark-sql</code> shell just the same.</p>
<pre class="prettyprint"><code class="language-python">def sql(stmt):
    return spark.sql(stmt)
</code></pre>
<h3><a href="#step-1-load-the-catalog" name="step-1-load-the-catalog" class="anchor"><span class="anchor-link"></span></a>Step 1: Load the catalog</h3>
<pre class="prettyprint"><code class="language-python">sql(&quot;CREATE OR REPLACE TEMPORARY VIEW modis USING `aws-pds-modis-catalog`&quot;)
</code></pre>
<h3><a href="#step-2-down-select-data-by-month" name="step-2-down-select-data-by-month" class="anchor"><span class="anchor-link"></span></a>Step 2: Down-select data by month</h3>
<pre class="prettyprint"><code class="language-python">sql(&quot;&quot;&quot;
CREATE OR REPLACE TEMPORARY VIEW red_nir_monthly_2017 AS
SELECT granule_id, month(acquisition_date) as month, B01 as red, B02 as nir
FROM modis
WHERE year(acquisition_date) = 2017 AND day(acquisition_date) = 15 AND granule_id = &#39;h21v09&#39;
&quot;&quot;&quot;)
sql(&#39;DESCRIBE red_nir_monthly_2017&#39;)
</code></pre>
<table>
  <thead>
    <tr>
      <th>col_name </th>
      <th>data_type </th>
      <th>comment </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>granule_id </td>
      <td>string </td>
    </tr>
    <tr>
      <td>month </td>
      <td>int </td>
    </tr>
    <tr>
      <td>red </td>
      <td>string </td>
    </tr>
    <tr>
      <td>nir </td>
      <td>string </td>
    </tr>
  </tbody>
</table>
<h3><a href="#step-3-read-tiles" name="step-3-read-tiles" class="anchor"><span class="anchor-link"></span></a>Step 3: Read tiles</h3>
<pre class="prettyprint"><code class="language-python">sql(&quot;&quot;&quot;
CREATE OR REPLACE TEMPORARY VIEW red_nir_tiles_monthly_2017
USING raster
OPTIONS (
    catalog_table=&#39;red_nir_monthly_2017&#39;,
    catalog_col_names=&#39;red,nir&#39;,
    tile_dimensions=&#39;256,256&#39;
    )
&quot;&quot;&quot;)
</code></pre>
<h3><a href="#step-4-compute-aggregates" name="step-4-compute-aggregates" class="anchor"><span class="anchor-link"></span></a>Step 4: Compute aggregates</h3>
<pre class="prettyprint"><code class="language-python">grouped = sql(&quot;&quot;&quot;
SELECT month, ndvi_stats.* FROM (
    SELECT month, rf_agg_stats(rf_normalized_difference(nir, red)) as ndvi_stats
    FROM red_nir_tiles_monthly_2017
    WHERE st_intersects(st_reproject(rf_geometry(red), rf_crs(red), &#39;EPSG:4326&#39;), st_makePoint(34.870605, -4.729727))
    GROUP BY month
    ORDER BY month
)
&quot;&quot;&quot;)
grouped
</code></pre>
<p><em>Showing only top 5 rows</em>.</p>
<table>
  <thead>
    <tr>
      <th>month </th>
      <th>data_cells </th>
      <th>no_data_cells </th>
      <th>min </th>
      <th>max </th>
      <th>mean </th>
      <th>variance </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1 </td>
      <td>65523 </td>
      <td>13 </td>
      <td>-0.2519809825673534 </td>
      <td>0.8644836272040303 </td>
      <td>0.4062596673810191 </td>
      <td>0.01407280838385605 </td>
    </tr>
    <tr>
      <td>2 </td>
      <td>65521 </td>
      <td>15 </td>
      <td>-0.21232123212321233 </td>
      <td>0.8872390789756832 </td>
      <td>0.46738863804011127 </td>
      <td>0.011822698212885174 </td>
    </tr>
    <tr>
      <td>3 </td>
      <td>64425 </td>
      <td>1111 </td>
      <td>-0.36211340206185566 </td>
      <td>0.9208261617900172 </td>
      <td>0.5811071411891395 </td>
      <td>0.011570245465885753 </td>
    </tr>
    <tr>
      <td>4 </td>
      <td>64236 </td>
      <td>1300 </td>
      <td>-0.17252657399836469 </td>
      <td>0.922397476340694 </td>
      <td>0.5254596885897274 </td>
      <td>0.01087259231886667 </td>
    </tr>
    <tr>
      <td>5 </td>
      <td>60819 </td>
      <td>4717 </td>
      <td>-0.19951338199513383 </td>
      <td>0.916626036079961 </td>
      <td>0.46471430090039234 </td>
      <td>0.01215478443067744 </td>
    </tr>
  </tbody>
</table>
<h2><a href="#scala" name="scala" class="anchor"><span class="anchor-link"></span></a>Scala</h2>
<p>The latest Scala API documentation is available here:</p>
<ul>
  <li><a href="https://rasterframes.io/latest/api/index.html">Scala API Documentation</a></li>
</ul>
<h3><a href="#step-1-load-the-catalog" name="step-1-load-the-catalog" class="anchor"><span class="anchor-link"></span></a>Step 1: Load the catalog</h3>
<pre class="prettyprint"><code class="language-scala">import geotrellis.proj4.LatLng
import org.locationtech.rasterframes._
import org.locationtech.rasterframes.datasource.raster._
import org.apache.spark.sql._
import org.apache.spark.sql.functions._


implicit val spark = SparkSession.builder()
  .master(&quot;local[*]&quot;)
  .appName(&quot;RasterFrames&quot;)
  .withKryoSerialization
  .getOrCreate()
  .withRasterFrames

import spark.implicits._

val modis = spark.read.format(&quot;aws-pds-modis-catalog&quot;).load()
</code></pre>
<h3><a href="#step-2-down-select-data-by-month" name="step-2-down-select-data-by-month" class="anchor"><span class="anchor-link"></span></a>Step 2: Down-select data by month</h3>
<pre class="prettyprint"><code class="language-scala">val red_nir_monthly_2017 = modis
  .select($&quot;granule_id&quot;, month($&quot;acquisition_date&quot;) as &quot;month&quot;, $&quot;B01&quot; as &quot;red&quot;, $&quot;B02&quot; as &quot;nir&quot;)
  .where(year($&quot;acquisition_date&quot;) === 2017 &amp;&amp; (dayofmonth($&quot;acquisition_date&quot;) === 15) &amp;&amp; $&quot;granule_id&quot; === &quot;h21v09&quot;)
</code></pre>
<h3><a href="#step-3-read-tiles" name="step-3-read-tiles" class="anchor"><span class="anchor-link"></span></a>Step 3: Read tiles</h3>
<pre class="prettyprint"><code class="language-scala">val red_nir_tiles_monthly_2017 = spark.read.raster
  .fromCatalog(red_nir_monthly_2017, &quot;red&quot;, &quot;nir&quot;)
  .load()
</code></pre>
<h3><a href="#step-4-compute-aggregates" name="step-4-compute-aggregates" class="anchor"><span class="anchor-link"></span></a>Step 4: Compute aggregates</h3>
<pre class="prettyprint"><code class="language-scala">val result = red_nir_tiles_monthly_2017
  .where(st_intersects(
    st_reproject(rf_geometry($&quot;red&quot;), rf_crs($&quot;red&quot;), LatLng),
    st_makePoint(34.870605, -4.729727)
  ))
  .groupBy(&quot;month&quot;)
  .agg(rf_agg_stats(rf_normalized_difference($&quot;nir&quot;, $&quot;red&quot;)) as &quot;ndvi_stats&quot;)
  .orderBy(&quot;month&quot;)
  .select(&quot;month&quot;, &quot;ndvi_stats.*&quot;)
  
result.show()  
</code></pre>
</div>
<div>
<a href="https://github.com/locationtech/rasterframes/tree/v0.9.1/pyrasterframes/target/python/docs/languages.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
0.9.1
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="ipython.html" title="IPython/Jupyter Extensions" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
IPython/Jupyter Extensions
</span>
</div>
</a>
<a href="reference.html" title="Function Reference" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
Function Reference
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
&copy; 2017-2019 <a href="https://astraea.earth">Astraea</a>, Inc. All rights reserved.
</div>
</div>
</div>
</div>
</footer>

</div>
<script src="assets/javascripts/application.583bbe55.js"></script>
<script src="assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"."}})</script>
<script type="text/javascript" src="lib/prettify/prettify.js"></script>
<script type="text/javascript" src="lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
<script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-106630615-1"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})});if(document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>

</body>
</html>
